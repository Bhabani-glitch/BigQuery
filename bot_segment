CREATE OR REPLACE FUNCTION `projectid.datsetid.getga4botseg`(source STRING, medium STRING, page_path STRING, browser_version STRING, page_title STRING, operating_system STRING, city STRING) RETURNS STRING AS (
CASE
    WHEN REGEXP_CONTAINS(source,'(Ä¸ve)|(Ã¿ve!)|(ÿve!)|(Ä¸ve!)') THEN 'Bot_traffic'
    WHEN browser_version LIKE '99.0.4844.82' THEN 'Bot_traffic'
    WHEN REGEXP_CONTAINS(LOWER(source), '(%esid%)|(%esid!)|(esid)') THEN 'Bot_traffic'
    WHEN REGEXP_CONTAINS(LOWER(source), 'zbexfgvat-dybhe') THEN 'Bot_traffic'
    WHEN REGEXP_CONTAINS(page_path,'ppinv=1') THEN 'Bot_traffic'
    WHEN REGEXP_CONTAINS(LOWER(source),'2mdn.net|(s3.amazonaws.com)|(example.com)') THEN 'Bot_traffic'
    WHEN REGEXP_CONTAINS(LOWER(source),'teva') THEN 'Other'
    WHEN REGEXP_CONTAINS(LOWER(source),'evfcybl|test') OR REGEXP_CONTAINS(LOWER(medium),'evfcybl|test') THEN 'Bot_traffic'
    WHEN REGEXP_CONTAINS(LOWER(source),'staging|prod|test|testpdf|localhost.*') OR REGEXP_CONTAINS(LOWER(medium),'test|testpdf|localhost.*') THEN 'Bot_traffic' 
    WHEN REGEXP_CONTAINS(LOWER(medium),'display') AND REGEXP_CONTAINS(LOWER(operating_system),'linux') AND REGEXP_CONTAINS(LOWER(city),'(not set)|Alpharetta|Anaheim|Ashburn|Atlanta|AvonPark|Baltimore|Berthoud|Cary|Charlotte|Cibolo|Clermont|Coffeyville|Columbus|Denver|Durham|Edmond|Fall River Mills|Feasterville-Trevose|Frankford|Garner|Greenville|Hamilton|Hollywood|Houston|Independence|Irvine|Jacksonville|Kaysville|Kennesaw|Kingsport|Little Rock|Lockport|Los Angeles|Louisville|Miami|Monroe Township|Montclair|Moore|New York|Newnan|Norman|Oklahoma City|Omaha|Orange|Owasso|Philadelphia|Pittsfield|Port Charlotte|Quincy|Raleigh|Ramsey|Redmond|Rochester|Rowland Heights|Sacramento|San Diego|Seattle|Shoreview|South Jordan|South Park Township|South Salt Lake|Temecula|Tulsa|Turner|Vallejo|Vinings|Walla Walla|Washington|West Jordan|West Valley City|Yonkers') THEN 'Bot_traffic' 
    WHEN REGEXP_CONTAINS(LOWER(source),'(websitebottraffic.pw)|(best.healthythingy.com)|(bing.com)|(clinsites.net)|(deref-mail.com)|(ganseapothecary.sharepoint.com)|(localhost:8002)|(s3.amazonaws.com)|(storage.googleapis.com)|(teva.kolconsult.meeting.austedo.rvw.relevatetechops.com)|(tevaussales--full.my.salesforce.com)|(versionista.com)|(wowhead.com)|(how-to-buy-bitcoins)') THEN 'Bot_traffic'
    WHEN REGEXP_CONTAINS(LOWER(source),r"^(brateg|budilneg|buketeg|bezlimitko|biteg|boltalko|begalka|alfabot|arendovalka|bank\-rot|abcdefh|aptechko|bukleteg|abc)\.xyz|(magnet\-to\-torrent|torrent\-to\-magnet)\.com|(baixar|descargar)\-musica|wordpress(\-start|\-crew)|uptime(robot|bot|check|\-alpha|\.com)|vitaly|sharebutton|semalt|ranksonic|share\-button|anticrawler|timer4web|free\-video\-tool|responsive\-test|dogsrun|fix\-website\-er|dailyrank|sitevaluation|seo\-2\-0\.|99seo|top10\-way|(videos|buttons)\-for\-your|best\-seo\-(solution|offer)|buttons\-for\-website|profit\.xyz|dbutton|keywords\-monitoring|platezhka|7makemoney|forum69|kings\-analytics|checkpagerank|pr\-cy\.ru|\-\-(production|website|sale)\.com|(audit|dollars|success|top1|amazon|commerce)\-seo|free\-video\-tool|datract|hacĸer|ɢoogl|slifty\.github|\-liar.ru|3\-letter\-|rencer\.ru|foxweber|free\-fbook|goodwriterssales|tourcroatia|spinnerco|justkillingti|suralink|worldtraveler|oldfaithfultaxi|christopherlane|hollywoodweeklymagazine|losangeles\-ads|anniemation|timdreby|pcimforum|yellowstonesafaritours|autoseo|blogarama|for\-placing|brainwizard|casinos4|ḷ\.com|davidsbag|bestonwardticket|presleycollectiblesm|\-backlinks\.com|phoenicx\.co\.uk|be\-escorts|vidyoze|brasseriebread|helvetiiconsulting|johntrapane|cloudsendchef|theautoprofit|:8888|blog1989|incomekey|amazon\-ads\.ovh|krumble\.net|10bestseo|seo\-watch|blog100|seoservices2018|resell\-seo|auto\-?seo|free\-website\-traffic|mycheaptraffic|(artblog|howblog|seobook)\.top|bestbaby\.life|(blogping|blogseo)\.xyz$") THEN 'Bot_traffic'
    WHEN REGEXP_CONTAINS(LOWER(page_title),r"^google-liar|whitehouse\.gov|life\.ru|vice\.com|vc\.ru|rencer\.ru|blackhatworld") THEN 'Bot_traffic'
    ELSE 'Other'
  END
);